<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aura Payment</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; text-align: center; padding: 40px 20px; background-color: #f8f9fa; }
        .card { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); max-width: 400px; margin: 0 auto; }
        .amount { font-size: 32px; font-weight: 800; color: #333; margin: 10px 0; }
        .note { color: #666; font-size: 14px; margin-bottom: 30px; }
        
        .btn { display: block; width: 100%; padding: 15px 0; margin: 10px 0; border-radius: 12px; font-weight: 600; text-decoration: none; font-size: 16px; transition: transform 0.2s; border: none; cursor: pointer; }
        .btn:active { transform: scale(0.98); }
        
        .btn-gpay { background-color: #ffffff; color: #3c4043; border: 1px solid #dadce0; }
        .btn-phonepe { background-color: #5f259f; color: white; }
        .btn-paytm { background-color: #00baf2; color: white; }
        .btn-bhim { background-color: #f26522; color: white; }
        
        /* Auto-redirect loader */
        .loader-container { margin-bottom: 20px; }
        .spinner { border: 3px solid #f3f3f3; border-top: 3px solid #333; border-radius: 50%; width: 24px; height: 24px; animation: spin 1s linear infinite; margin: 0 auto; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
    <script>
        window.onload = function() {
            const params = new URLSearchParams(window.location.search);
            const pa = params.get('pa'); 
            const am = params.get('am');
            const pn = params.get('pn') || "Merchant";
            const tn = params.get('tn') || "";
            
            if (pa && am) {
                // Display Data
                document.getElementById('amount-display').innerText = "â‚¹" + am;
                document.getElementById('note-display').innerText = tn ? "For: " + tn : "Payment Request";
                document.getElementById('payee-display').innerText = "Paying: " + pn;

                const encodedPn = encodeURIComponent(pn);
                const encodedTn = encodeURIComponent(tn);
                
                // Base UPI String
                const baseParams = `pa=${pa}&am=${am}&pn=${encodedPn}&tn=${encodedTn}&cu=INR`;
                const upiLink = `upi://pay?${baseParams}`;

                // Specific App Links (Force iOS to open specific apps)
                const gpayLink = `tez://upi/pay?${baseParams}`; 
                const phonepeLink = `phonepe://pay?${baseParams}`;
                const paytmLink = `paytmmp://pay?${baseParams}`;
                
                // Set Buttons
                document.getElementById('btn-gpay').href = gpayLink;
                document.getElementById('btn-phonepe').href = phonepeLink;
                document.getElementById('btn-paytm').href = paytmLink;
                document.getElementById('btn-bhim').href = upiLink; // Generic fallback

                // Auto-try generic UPI after 1 second (Good for Android)
                setTimeout(() => {
                    window.location.href = upiLink;
                }, 800);
            } else {
                document.body.innerHTML = "<h3>Invalid Link</h3>";
            }
        };
    </script>
</head>
<body>
    <div class="card">
        <div class="loader-container">
            <p style="font-size: 12px; color: #999; margin-bottom: 8px;">redirecting...</p>
            <div class="spinner"></div>
        </div>

        <div id="payee-display" style="font-weight: 600; color: #555;"></div>
        <div id="amount-display" class="amount"></div>
        <div id="note-display" class="note"></div>

        <!-- Explicit Buttons for iOS Users -->
        <a id="btn-gpay" class="btn btn-gpay">Google Pay</a>
        <a id="btn-phonepe" class="btn btn-phonepe">PhonePe</a>
        <a id="btn-paytm" class="btn btn-paytm">Paytm</a>
        <a id="btn-bhim" class="btn btn-bhim">Other UPI Apps</a>
    </div>
</body>
</html>
